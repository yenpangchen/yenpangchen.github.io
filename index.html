<!DOCTYPE html>
<html>
	<head>
		<title>比特幣匯率轉換</title>
	</head>
	<body style="text-align: center;align-items: center; display: flex; flex-direction: column;">
		<div>
			<center>
				<p>
					<font size = "5">比特幣轉換美金小工具</font>
				</p>
			</center>
		</div>
		<div>
			<span>匯率日期</span>
			<input type="date" id="newDate" />
			<input type="number" id="quantity" />
			<span>比特幣</span>
			<button onclick="myfunction()">轉換</button>
			<span id="result">為 美金</span>
		</div>
		<div style="width: 50%; height: 200px; margin-top: 30px; border: 2px solid rgb(155,200,155);">
			<div style="width: 100%; height: 50%; background-color:#CCE6CD; display: grid; place-items: center;">
				<h4>當前匯率</h4>
			</div>
			<div style="width: 100%; height: 50%; display: grid; place-items: center;">
				<p id="bitcoinprice">1 比特幣約 美金</p>
			</div>
		</div>
		<script>
			function myfunction() {
				var date = document.querySelector("#newDate").value;
				var quantity = document.querySelector("#quantity").value;
				var bitcoinprice = document.querySelector("#bitcoinprice");
				var total = document.querySelector("#result");
				if (date.length > 0) {
					fetch(`https://api.coindesk.com/v1/bpi/historical/close.json?start=${date}&end=${date}`)
					.then((result) => result.json())
					.then((resultJson) => {
						bitcoinprice.innerHTML = `1 比特幣約 ${resultJson.bpi[date]} 美金`;
						total.innerHTML = `為 ${parseFloat(quantity) * parseFloat(resultJson.bpi[date])} 美金`;})
					.catch((err) => {
						console.log(err);
						alert("查無該日期匯率資料！");});}
				else {alert("日期格式錯誤！!");}
			}
		</script>
	</body>
</html>
